if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

########################
# history
########################
HISTFILE=~/.zsh_history
HISTSIZE=10000
SAVEHIST=10000
setopt EXTENDED_HISTORY HIST_REDUCE_BLANKS HIST_IGNORE_SPACE NO_BANG_HIST HIST_IGNORE_DUPS

########################
# completion
########################
autoload -Uz compinit
compinit
zstyle ':completion:*' menu select

########################
# title
########################
autoload -Uz add-zsh-hook
function xterm_title_precmd () {
  print -Pn -- '\e]2;%n@%m %~\a'
  [[ "$TERM" == 'screen'* ]] && print -Pn -- '\e_\005{g}%n\005{-}@\005{m}%m\005{-} \005{B}%~\005{-}\e\\'
}

function xterm_title_preexec () {
  print -Pn -- '\e]2;%n@%m %~ %# ' && print -n -- "${(q)1}\a"
  [[ "$TERM" == 'screen'* ]] && { print -Pn -- '\e_\005{g}%n\005{-}@\005{m}%m\005{-} \005{B}%~\005{-} %# ' && print -n -- "${(q)1}\e\\"; }
}

if [[ "$TERM" == (Eterm*|alacritty*|aterm*|gnome*|konsole*|kterm*|putty*|rxvt*|screen*|tmux*|xterm*) ]]; then
  add-zsh-hook -Uz precmd xterm_title_precmd
  add-zsh-hook -Uz preexec xterm_title_preexec
fi

########################
# plugin options
########################
ZSH_AUTOSUGGEST_MANUAL_REBIND=1
HISTORY_SUBSTRING_SEARCH_PREFIXED=1

########################
# plugins
########################
{% for plugin in zsh_plugins %}
{% if plugin.git is defined  %}
source {{ zsh_plugin_dir }}/{{ plugin.name }}/{{ plugin.name }}.zsh
{% else %}
source {{ zsh_plugin_dir }}/{{ plugin.name }}.zsh
{% endif %}
{% endfor %}

########################
# keybinds
########################
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down

########################
# aliases
########################
alias c='clear'
alias q='exit'
alias ls='ls --color=auto'
alias la='ls --color=auto -la'
alias ll='ls --color=auto -laZ'
alias grep='grep --color=auto'
alias ip='ip -color=auto'
alias getip='curl -4 -s https://api64.ipify.org; echo'
alias getip6='curl -6 -s https://api64.ipify.org; echo'

alias cat='bat'
alias diff='delta'

source ~/.zsh/powerlevel10k/powerlevel10k.zsh-theme
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh
